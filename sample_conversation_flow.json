{
    "global_prompt": "Your name is Clara. You're always very charismatic, with a cheerful and lively voice.\n\n## Objective:\nConfirm identity, understand the need, suggest the ideal doctor, and conclude the consultation politely and naturally.\n\n## Style Principles\n- Be concise: Keep answers to less than two sentences, unless explaining complex topics.\n- Present the doctor's authority only once. Never repeat it in any case. If needed, simply answer.\n- Don't be too tied to the script. Be more natural and fluid.\n- Use SSML for pacing (<break time='500ms'/>, slower speech, emphasis).\n- Be conversational: Use natural language, contractions, and acknowledge what the speaker is saying.\n- Be empathetic: Demonstrate understanding of the speaker's situation.\n- **CRITICAL**: If you have already presented doctor's credentials/authority once, NEVER repeat them again. If user asks questions, answer directly without re-explaining the doctor's background.\n- **CRITICAL**: If user shows signs of wanting to end the call (says goodbye, mentions being in a hurry, etc.), respect their time and conclude politely without repeating information.\n- **CRITICAL**: Always acknowledge what the user says before transitioning to a new topic. Never ignore their questions or comments.\n- **CRITICAL**: Use natural transitions between topics. Avoid abrupt jumps like \"Let me quickly explain how it works\" without context.\n\n## Conversation Flow Guidelines\n- Always respond to user's questions before proceeding\n- Use acknowledgment phrases: \"Entendi\", \"Perfeito\", \"Que bom saber\"\n- Bridge topics naturally: \"Com base no que você me contou...\", \"Então, deixe eu te explicar...\"\n- Wait for user responses - don't rush through the script\n- Be genuinely interested in their responses\n\n## Response Guidelines\nReturn dates in spoken format: Say \"dezessete de setembro\" and not \"17/09\" and Say “Dezessete de setembro de dois mil e vinte e cinco” and not \"17/09/2025\"\nAsk one question at a time: Avoid overwhelming the other person with multiple questions.\n\nConfirm understanding: Paraphrase important information for the other person.\nWhen speaking the phone number, transform the format as follows:\n- Insert formats such as 9132\n- Should be pronounced as: \"nine one three two\"\n- Important: Do not omit the space around the hyphen when speaking\n\nRules:\n• Speak in a calm and positive tone, using short sentences, and confirm understanding.\n• If the patient interrupts, stop and respond.\n• For payment, offer a link via WhatsApp (preferably) or SMS, as preferred.\n• Never make up facts; Use only variables and functions. Context (if available):\n– Name: {{name}}, Last WhatsApp message: {{phone_last4}}\n– City: {{city}}, Specialty: {{specialty}}, Reason: {{reason}}\n– Suggested doctor: {{doctor_name}} ({{doctor_specialty}}), {{doctor_city}}. Telemedicine: {{telemedicine}}. Languages: {{doctor_languages}}. Focus: {{doctor_tags}}. Brief bio: {{doctor_description}}. Fees: {{price_first}}, return {{price_return}}.\nClosing: After sending the payment link, explain that you can send the receipt via WhatsApp. If you don't pay now, offer to reschedule quickly.",
    "nodes": [
        {
            "tool_id": "tool-1757295373150",
            "name": "Check-identity",
            "edges": [
                {
                    "destination_node_id": "node-1757362744711",
                    "id": "edge-1757330728173",
                    "transition_condition": {
                        "type": "equation",
                        "equations": [
                            {
                                "left": "{{result}}",
                                "operator": "==",
                                "right": "ok"
                            }
                        ],
                        "operator": "&&"
                    }
                }
            ],
            "id": "node-1757295380230",
            "type": "function",
            "tool_type": "local",
            "speak_during_execution": false,
            "display_position": {
                "x": 1107.4103824193082,
                "y": 1490.437918197066
            },
            "wait_for_result": true
        },
        {
            "instruction": {
                "type": "prompt",
                "text": "**IMPORTANT**: This node should present doctor authority ONLY ONCE per conversation. If you have already presented the doctor's credentials, DO NOT repeat them.\n\n**IF THIS IS THE FIRST TIME presenting the doctor:**\n\n**Step 1 - Natural Transition:**\n\"Com base no que você me contou, tenho o médico perfeito para o seu caso. <break time='400ms'/>\"\n\n**Step 2 - Autoridade (present naturally):**\nApresente as credenciais e especialidades do médico em um tom profissional, mas acolhedor. Fale devagar (5% mais devagar), com ênfase em conquistas e reputação.\n\"{{doctor_name}} é especialista em {{doctor_specialty}}, {{doctor_description}} <break time='500ms'/>\"\nFinalize esta parte com uma pergunta leve e envolvente: \"Isso parece alinhado com o que você está procurando? <break time='400ms'/>\"\n\n<aguarde a resposta do usuário>\n\n**Step 3 - Como funciona o serviço (only if user shows interest):**\n\"Perfeito! Então deixe eu te explicar rapidamente como funciona... <break time='400ms'/>\"\nForneça uma explicação clara e profissional do processo de consulta.\nUse um tom tranquilizador e confiante. Mencione claramente a duração e {{price_first}}.\n\"A consulta com o {{doctor_name}} tem duração média de 1,5 hora para um atendimento atencioso e personalizado. <break time='500ms'/> O valor é de {{price_first}} e inclui um retorno em 30 dias. <break time='400ms'/> Se você tiver plano de saúde, emitiremos uma nota para reembolso.\"\n\n**Step 4 - Escassez:**\n\"A agenda dele está bem cheia no momento, mas tenho uma vaga disponível para {{initial_appointment_date}}. <break time='400ms'/> Gostaria que eu reservasse essa vaga para você?\"\n\n**IF YOU HAVE ALREADY PRESENTED THE DOCTOR BEFORE:**\n- Simply answer the user's specific question\n- Do NOT repeat credentials, background, or authority information\n- Focus only on addressing their current concern\n- Be concise and respectful of their time\n\nUse SSML para ritmo (<break time='500ms'/>, fala mais lenta, ênfase).\n\n**NEVER REPEAT DOCTOR'S AUTHORITY/CREDENTIALS INFORMATION ONCE IT HAS BEEN PRESENTED.**\n**ALWAYS USE NATURAL TRANSITIONS BETWEEN TOPICS.**"
            },
            "model_choice": {
                "type": "cascading",
                "model": "gpt-4.1",
                "high_priority": true
            },
            "name": "Authority_Scarcity",
            "edges": [
                {
                    "destination_node_id": "node-1757798419221",
                    "id": "edge-1757356852686",
                    "transition_condition": {
                        "type": "prompt",
                        "prompt": "IF NOt.. MAYBE , SO FAR...I'm Doubt >>> Se NÃO / muito longe / não consigo esperar / não funciona:"
                    }
                },
                {
                    "destination_node_id": "node-1757361151618",
                    "id": "edge-1757356871972",
                    "transition_condition": {
                        "type": "prompt",
                        "prompt": "O usuário diz que pode esperar até que isso aconteça e diz Pode ser"
                    }
                },
                {
                    "destination_node_id": "node-1758045897572",
                    "id": "edge-1757356883874",
                    "transition_condition": {
                        "type": "prompt",
                        "prompt": "Se talvez / pode ser / indeciso:"
                    }
                }
            ],
            "id": "node-1757296784338",
            "knowledge_base_ids": [
                "knowledge_base_ee0b3888fd017604"
            ],
            "type": "conversation",
            "display_position": {
                "x": 1468.8893945622335,
                "y": 792.0174424772282
            }
        },
        {
            "instruction": {
                "type": "prompt",
                "text": "**Natural Flow Instructions:**\n\nFirst acknowledge what the user shared:\n\"Entendi, {{name}}. <break time='400ms'/>\"\n\nThen ask follow-up questions to understand their needs:\n\"O que você está sentindo? Consegue me explicar melhor para eu direcionar para o médico com a especialidade que você precisa? <break time='500ms'/>\"\n\n**Instead of immediately explaining services, use natural transitions:**\n- \"Deixe eu te explicar como funciona\" ❌ (too abrupt)\n- \"Com base no que você me contou, eu tenho algumas opções que podem te ajudar...\" ✅ (natural transition)\n- \"Perfeito! Então, vou te contar rapidamente como podemos te ajudar...\" ✅ (acknowledges first)\n\n**Understand user needs and urgency naturally through conversation:**\n- Ask about pain level, duration, impact on daily life\n- Understand their timeline and availability\n- Listen to their concerns before proposing solutions\n\nUse SSML for pacing (<break time='500ms'/>, slower speech, emphasis).\n\n**CRITICAL**: Always acknowledge what the user said before transitioning to next topic."
            },
            "model_choice": {
                "type": "cascading",
                "model": "gpt-4.1",
                "high_priority": false
            },
            "name": "Discovery_Urgency",
            "edges": [
                {
                    "destination_node_id": "node-1757296784338",
                    "id": "edge-1757298321223",
                    "transition_condition": {
                        "type": "prompt",
                        "prompt": "After confirm what user need and how urgent it is"
                    }
                }
            ],
            "id": "node-1757298321223",
            "knowledge_base_ids": [
                "knowledge_base_1b372eddb81da5d0",
                "knowledge_base_ee0b3888fd017604"
            ],
            "type": "conversation",
            "display_position": {
                "x": 666.8546674185347,
                "y": 444.1995529609704
            }
        },
        {
            "name": "Goodbye_end",
            "id": "node-1757330614671",
            "type": "end",
            "display_position": {
                "x": 4425.53906798816,
                "y": 3365.8494413453614
            },
            "instruction": {
                "type": "prompt",
                "text": "Politely end the call"
            }
        },
        {
            "name": "mismatched_reason",
            "edges": [
                {
                    "destination_node_id": "node-1757295380230",
                    "id": "edge-1757358405416",
                    "transition_condition": {
                        "type": "prompt",
                        "prompt": "After extracting variables"
                    }
                }
            ],
            "variables": [
                {
                    "name": "mismatched_reason",
                    "description": "Extract reason why the info is not correct",
                    "type": "string",
                    "choices": []
                },
                {
                    "name": "lead_id",
                    "description": "current {{lead_id}}",
                    "type": "string",
                    "choices": []
                }
            ],
            "id": "node-1757358405416",
            "type": "extract_dynamic_variables",
            "display_position": {
                "x": 671.7461399333002,
                "y": 1137.3553554974712
            }
        },
        {
            "name": "222",
            "edges": [
                {
                    "destination_node_id": "node-1757365240407",
                    "id": "edge-1757365459207",
                    "transition_condition": {
                        "type": "prompt",
                        "prompt": "Always->Extract_Variables"
                    }
                }
            ],
            "id": "node-1757361151618",
            "type": "conversation",
            "display_position": {
                "x": 2561.2959103159,
                "y": 513.4369670393966
            },
            "instruction": {
                "type": "prompt",
                "text": "Perfeito. Vou te enviar um **link de pagamento seguro** para garantir a vaga.\nVocê prefere receber por **WhatsApp** ou **SMS**?\n\n"
            }
        },
        {
            "instruction": {
                "type": "prompt",
                "text": "Parece que houve um desencontro de dados. Vou registrar como *lead divergente* para nossa equipe revisar.\nObrigado(a) e tenha um bom dia!"
            },
            "name": "666",
            "edges": [
                {
                    "id": "edge-1757362744711",
                    "transition_condition": {
                        "type": "prompt",
                        "prompt": "Goodbye_end(Ending)"
                    }
                }
            ],
            "id": "node-1757362744711",
            "type": "conversation",
            "display_position": {
                "x": 1536.6108656916347,
                "y": 1737.0649564800995
            },
            "skip_response_edge": {
                "destination_node_id": "node-1757330614671",
                "id": "edge-1757417266249",
                "transition_condition": {
                    "type": "prompt",
                    "prompt": "Skip response"
                }
            }
        },
        {
            "tool_id": "tool-1757365061137",
            "instruction": {
                "type": "prompt",
                "text": "Define what to say when calling the function"
            },
            "model_choice": {
                "type": "cascading",
                "model": "gpt-4.1",
                "high_priority": true
            },
            "name": "Create Payment Link",
            "edges": [
                {
                    "destination_node_id": "node-1757418992953",
                    "id": "edge-1757366600226",
                    "transition_condition": {
                        "type": "equation",
                        "equations": [
                            {
                                "left": "{{preferred_channel}}",
                                "operator": "==",
                                "right": "whatsapp"
                            }
                        ],
                        "operator": "||"
                    }
                },
                {
                    "destination_node_id": "node-1757419065849",
                    "id": "edge-1757366631232",
                    "transition_condition": {
                        "type": "equation",
                        "equations": [
                            {
                                "left": "{{preferred_channel}}",
                                "operator": "==",
                                "right": "sms"
                            }
                        ],
                        "operator": "||"
                    }
                }
            ],
            "id": "node-1757365066232",
            "type": "function",
            "tool_type": "local",
            "speak_during_execution": true,
            "display_position": {
                "x": 4166.14803711099,
                "y": 1046.0782416704712
            },
            "wait_for_result": true
        },
        {
            "variables": [
                {
                    "name": "preferred_channel",
                    "description": "whatsapp → synonyms: whatsapp, zap, aqui mesmo, mensagem\n\nsms → sms, texto",
                    "type": "string",
                    "choices": []
                }
            ],
            "model_choice": {
                "type": "cascading",
                "model": "gpt-4.1",
                "high_priority": true
            },
            "name": "Extract Variables",
            "edges": [
                {
                    "destination_node_id": "node-1757365623385",
                    "id": "edge-1757365669871",
                    "transition_condition": {
                        "type": "prompt",
                        "prompt": "Always->Save Preference"
                    }
                }
            ],
            "id": "node-1757365240407",
            "type": "extract_dynamic_variables",
            "display_position": {
                "x": 3291.691215234065,
                "y": 758.1077313384549
            }
        },
        {
            "tool_id": "tool-1757365620921",
            "model_choice": {
                "type": "cascading",
                "model": "gpt-4.1",
                "high_priority": true
            },
            "name": "Save Preference",
            "edges": [
                {
                    "destination_node_id": "node-1757365066232",
                    "id": "edge-1757366272080",
                    "transition_condition": {
                        "type": "prompt",
                        "prompt": "Always->Create Payment Link"
                    }
                }
            ],
            "id": "node-1757365623385",
            "type": "function",
            "tool_type": "local",
            "speak_during_execution": false,
            "display_position": {
                "x": 3762.6860700674893,
                "y": 950.1844896631428
            },
            "wait_for_result": true
        },
        {
            "tool_id": "tool-1757418989577",
            "model_choice": {
                "type": "cascading",
                "model": "gpt-5-mini",
                "high_priority": true
            },
            "name": "Send Link Wa",
            "edges": [
                {
                    "destination_node_id": "node-1757419090465",
                    "id": "edge-1757478801091",
                    "transition_condition": {
                        "type": "prompt",
                        "prompt": "Always confirm_sent"
                    }
                }
            ],
            "id": "node-1757418992953",
            "type": "function",
            "tool_type": "local",
            "speak_during_execution": false,
            "display_position": {
                "x": 4041.718526733238,
                "y": 1923.0623796929472
            },
            "wait_for_result": true
        },
        {
            "tool_id": "tool-1757419062296",
            "model_choice": {
                "type": "cascading",
                "model": "gpt-5-mini",
                "high_priority": true
            },
            "name": "Send Link Sms",
            "edges": [
                {
                    "destination_node_id": "node-1757419090465",
                    "id": "edge-1757478777804",
                    "transition_condition": {
                        "type": "prompt",
                        "prompt": "Always confirm_sent"
                    }
                }
            ],
            "id": "node-1757419065849",
            "type": "function",
            "tool_type": "local",
            "speak_during_execution": false,
            "display_position": {
                "x": 4079.1247689474358,
                "y": 1712.2284689321214
            },
            "wait_for_result": true
        },
        {
            "name": "777",
            "edges": [
                {
                    "destination_node_id": "node-1757330614671",
                    "id": "edge-1757419090465",
                    "transition_condition": {
                        "type": "prompt",
                        "prompt": "User say Bye"
                    }
                }
            ],
            "id": "node-1757419090465",
            "type": "conversation",
            "display_position": {
                "x": 4540.592706124255,
                "y": 2246.0359975600395
            },
            "instruction": {
                "type": "prompt",
                "text": "Acabei de te enviar o link. Você pode pagar quando quiser e me enviar o recibo por WhatsApp depois. Caso não haja resposta, o agendamento será cancelado automaticamente, ok?\n\n**IMPORTANT**: If user says goodbye or wants to end the call, simply thank them and end politely. DO NOT repeat doctor information or credentials again."
            }
        },
        {
            "finetune_conversation_examples": [],
            "instruction": {
                "type": "prompt",
                "text": "Always deliver the script step by step, never all at once.\nUse a warm, natural tone (like a real call center professional).\nAfter each sentence, pause and wait for the user's reply before moving forward.\nUse SSML for pacing (<break time='500ms'/>, slower speech, emphasis).\n\n**CRITICAL**: Be conversational and natural. If user asks how you are, respond warmly before continuing.\n\nFlow:\n\n1. Saudação calorosa:\n\"Olá {{name}}, eu sou a Clara, assistente no consultório do {{doctor_name}}. <break time='400ms'/> Como você está hoje?\"\n→ Stop and wait for user's answer.\n→ **If user asks how you are**: Respond naturally like \"Estou ótima, obrigada por perguntar! <break time='300ms'/>\" before continuing.\n\n2. Contextualização (use natural transition):\n\"Que bom saber que você está bem! <break time='400ms'/> Então, nós recebemos seu contato com interesse em agendar uma consulta conosco. <break time='500ms'/> Isso mesmo?\"\n→ Stop and wait for user's answer.\n\n3. Convite para bate-papo:\n\"Você pode me contar um pouquinho do que está acontecendo, só para eu entender melhor como podemos te ajudar? <break time='500ms'/>\"\n→ Stop and listen. Don't continue until user replies.\n\n4. Confirmação de informações:\n\"Antes da gente continuar, você poderia, por gentileza, me confirmar seus dados? Seu nome é {{name}} e o final do seu celular é {{phone_last4}}, certo?\"\n→ Stop and wait for confirmation.\n\nImportant:\n- Do not read the whole script in one go.\n- Always give the user a chance to answer before moving to the next line.\n- Keep a natural, patient rhythm (5% slower pace).\n- **ALWAYS acknowledge and respond to user's questions or comments before continuing.**\n- Be genuinely conversational, not robotic."
            },
            "name": "Greeting_identity",
            "edges": [
                {
                    "destination_node_id": "node-1757298321223",
                    "id": "edge-1757535785664",
                    "transition_condition": {
                        "type": "prompt",
                        "prompt": "O usuário confirma que o nome e o número do WhatsApp estão corretos\n(ex: você está certo. Isso mesmo. OK. etc.)"
                    }
                },
                {
                    "destination_node_id": "node-1757358405416",
                    "id": "edge-1757536029417",
                    "transition_condition": {
                        "type": "prompt",
                        "prompt": "O usuário diz que não está correto.\nSe a informação estiver incorreta, você extrai a variável {{mismatched_reason}} e chama a função Check-identity."
                    }
                }
            ],
            "id": "node-1757535785664",
            "type": "conversation",
            "display_position": {
                "x": 155.72342763662806,
                "y": 34.89505762466654
            }
        },
        {
            "finetune_conversation_examples": [
                {
                    "transcript": [
                        {
                            "content": "É muito longe.",
                            "role": "user"
                        },
                        {
                            "content": "Entendo perfeitamente. Mas posso tentar marcar uma consulta para você na semana que vem ou na outra, o que você acha?",
                            "role": "agent"
                        }
                    ],
                    "id": "fe-1757798473894"
                }
            ],
            "instruction": {
                "type": "prompt",
                "text": "Se o usuário responder que não pode esperar até a data disponível, gere uma oferta alternativa educada.\nUse um tom acolhedor e empático. Sugira tentar garantir um horário mais cedo, sem fazer promessas precipitadas.\n\nexemplo: \"Entendi, a agenda dele geralmente é concorrida. Mas eu posso tentar um encaixe e te retornar — Podemos fazer assim, eu te retorno em até dois dias\" (agente aguarda a resposta)"
            },
            "name": "111",
            "edges": [
                {
                    "destination_node_id": "node-1757807838768",
                    "id": "edge-1757798419221",
                    "transition_condition": {
                        "type": "prompt",
                        "prompt": "User agree with this suggestion"
                    }
                },
                {
                    "destination_node_id": "node-1757798764782",
                    "id": "edge-1757798531102",
                    "transition_condition": {
                        "type": "prompt",
                        "prompt": "User don't agree with this suggestion"
                    }
                }
            ],
            "id": "node-1757798419221",
            "type": "conversation",
            "display_position": {
                "x": 2026.003577712379,
                "y": 413.2269560783212
            }
        },
        {
            "name": "555",
            "edges": [
                {
                    "destination_node_id": "node-1757330614671",
                    "id": "edge-1757798764782",
                    "transition_condition": {
                        "type": "prompt",
                        "prompt": "User say Bye"
                    }
                }
            ],
            "id": "node-1757798764782",
            "type": "conversation",
            "display_position": {
                "x": 1926.993695978657,
                "y": 2497.4317129335723
            },
            "instruction": {
                "type": "prompt",
                "text": "Sem problemas, eu entendo perfeitamente. Estaremos disponíveis a qualquer momento caso mude de ideia no futuro. Desejamos a você uma recuperação tranquila e um ótimo dia."
            }
        },
        {
            "name": "444",
            "edges": [
                {
                    "destination_node_id": "node-1757330614671",
                    "id": "edge-1757807838768",
                    "transition_condition": {
                        "type": "prompt",
                        "prompt": "User say Bye"
                    }
                }
            ],
            "id": "node-1757807838768",
            "type": "conversation",
            "display_position": {
                "x": 3695.113793485162,
                "y": 2629.1361946900333
            },
            "instruction": {
                "type": "prompt",
                "text": "Informaremos a programação possível em até 2 dias. Agradecemos o seu tempo!"
            }
        },
        {
            "name": "333",
            "edges": [
                {
                    "destination_node_id": "node-1757807838768",
                    "id": "edge-1758045897572",
                    "transition_condition": {
                        "type": "prompt",
                        "prompt": "User agree this suggestion"
                    }
                },
                {
                    "destination_node_id": "node-1757798764782",
                    "id": "edge-1758046179191",
                    "transition_condition": {
                        "type": "prompt",
                        "prompt": "User don't agree this suggestion"
                    }
                }
            ],
            "id": "node-1758045897572",
            "type": "conversation",
            "display_position": {
                "x": 2590.5170147841486,
                "y": 990.7073634354022
            },
            "instruction": {
                "type": "prompt",
                "text": "Sem problema. Para não perdermos chances, posso deixar tentado o encaixe e, se eu conseguir, te aviso em até 2 dias. Tudo bem assim?"
            }
        }
    ],
    "start_node_id": "node-1757535785664",
    "start_speaker": "user",
    "tools": [
        {
            "headers": {},
            "parameter_type": "form",
            "method": "POST",
            "query_params": {
                "lead_id": "{{lead_id}}",
                "mismatched_reason": "{{mismatched_reason}}"
            },
            "description": "",
            "type": "custom",
            "url": "https://agent.geniumed.ai/fn/check-identity",
            "tool_id": "tool-1757295373150",
            "args_at_root": false,
            "timeout_ms": 120000,
            "name": "Check-identity",
            "response_variables": {
                "result": "result"
            },
            "parameters": {
                "type": "object",
                "properties": {
                    "lead_id": {
                        "type": "string",
                        "description": ""
                    },
                    "mismatched_reason": {
                        "type": "string",
                        "description": ""
                    }
                }
            }
        },
        {
            "headers": {},
            "parameter_type": "form",
            "method": "POST",
            "query_params": {
                "need": "{{symptoms_or_need}}",
                "urgency": "{{urgency}}",
                "specialty": "{{specialty}}"
            },
            "description": "",
            "type": "custom",
            "url": "https://agent.geniumed.ai/fn/recommend_doctor",
            "tool_id": "tool-1757332007477",
            "args_at_root": false,
            "timeout_ms": 120000,
            "name": "Maybe_recommend_doctor",
            "response_variables": {
                "doctor_id": "doctor.id",
                "doctor_description": "doctor.description",
                "telemedicine": "doctor.telemedicine",
                "doctor_specialty": "doctor_specialty",
                "doctor_tags": "doctor.tags",
                "doctor_city": "doctor.city",
                "doctor_languages": "doctor.languages",
                "doctor_name": "doctor_name"
            },
            "parameters": {
                "type": "object",
                "properties": {
                    "args": {
                        "type": "object",
                        "description": "",
                        "properties": {
                            "need": {
                                "type": "string",
                                "description": ""
                            },
                            "urgency": {
                                "type": "number",
                                "description": ""
                            },
                            "specialty": {
                                "type": "string",
                                "description": ""
                            }
                        }
                    }
                }
            }
        },
        {
            "headers": {},
            "parameter_type": "form",
            "method": "POST",
            "query_params": {
                "description": "Consulta com {{doctor_name}} ({{doctor_specialty}})",
                "lead_id": "{{lead_id}}",
                "amount": "{{price_first}}"
            },
            "description": "",
            "type": "custom",
            "url": "https://agent.geniumed.ai/fn/create-payment-link",
            "tool_id": "tool-1757365061137",
            "args_at_root": false,
            "timeout_ms": 120000,
            "name": "Create_payment_link",
            "response_variables": {
                "url": "url"
            },
            "parameters": {
                "type": "object",
                "properties": {
                    "description": {
                        "type": "string",
                        "description": ""
                    },
                    "lead_id": {
                        "type": "string",
                        "description": ""
                    },
                    "amount": {
                        "type": "string",
                        "description": ""
                    }
                }
            }
        },
        {
            "headers": {},
            "parameter_type": "form",
            "method": "POST",
            "query_params": {
                "lead_id": "{{lead_id}}",
                "preferred_channel": "{{preferred_channel}}"
            },
            "description": "",
            "type": "custom",
            "url": "https://agent.geniumed.ai/fn/set-communication-preference",
            "tool_id": "tool-1757365620921",
            "args_at_root": false,
            "timeout_ms": 120000,
            "name": "Save_preference",
            "response_variables": {
                "ok": "ok"
            },
            "parameters": {
                "type": "object",
                "properties": {
                    "description": {
                        "type": "string",
                        "description": ""
                    },
                    "lead_id": {
                        "type": "string",
                        "description": ""
                    },
                    "preferred_channel": {
                        "type": "string",
                        "description": ""
                    }
                }
            }
        },
        {
            "headers": {},
            "parameter_type": "form",
            "method": "POST",
            "query_params": {
                "when_iso": "{{when_time_iso}}",
                "lead_id": "{{lead_id}}"
            },
            "description": "",
            "type": "custom",
            "url": "https://agent.geniumed.ai/fn/schedule-call",
            "tool_id": "tool-1757416342856",
            "args_at_root": false,
            "timeout_ms": 120000,
            "name": "Schedule_call",
            "response_variables": {
                "schedule_status": "ok"
            },
            "parameters": {
                "type": "object",
                "properties": {
                    "args": {
                        "type": "object",
                        "description": "",
                        "properties": {
                            "when_time_iso": {
                                "type": "string",
                                "description": ""
                            },
                            "lead_id": {
                                "type": "string",
                                "description": ""
                            }
                        }
                    }
                }
            }
        },
        {
            "headers": {
                "url": "payment_url",
                "to": "{{phone}}"
            },
            "parameter_type": "form",
            "method": "POST",
            "query_params": {},
            "description": "",
            "type": "custom",
            "url": "https://agent.geniumed.ai/fn/send-payment-link",
            "tool_id": "tool-1757418989577",
            "args_at_root": false,
            "timeout_ms": 120000,
            "name": "Send_link_WA",
            "response_variables": {},
            "parameters": {
                "type": "object",
                "properties": {
                    "url": {
                        "type": "string",
                        "description": ""
                    },
                    "to": {
                        "type": "string",
                        "description": ""
                    }
                }
            }
        },
        {
            "headers": {
                "url": "{{payment_url}}",
                "to": "{{phone}}"
            },
            "parameter_type": "form",
            "method": "POST",
            "query_params": {},
            "description": "",
            "type": "custom",
            "url": "https://agent.geniumed.ai/fn/send-payment-link",
            "tool_id": "tool-1757419062296",
            "args_at_root": false,
            "timeout_ms": 120000,
            "name": "Send_link_SMS",
            "response_variables": {},
            "parameters": {
                "type": "object",
                "properties": {
                    "url": {
                        "type": "string",
                        "description": ""
                    },
                    "to": {
                        "type": "string",
                        "description": ""
                    }
                }
            }
        }
    ],
    "model_choice": {
        "type": "cascading",
        "model": "gpt-4.1",
        "high_priority": false
    },
    "model_temperature": 0.3,
    "tool_call_strict_mode": false,
    "knowledge_base_ids": [
        "knowledge_base_ee0b3888fd017604",
        "knowledge_base_1b372eddb81da5d0"
    ],
    "kb_config": {
        "top_k": 3,
        "filter_score": 0.6
    },
    "begin_tag_display_position": {
        "x": -133.09621416225406,
        "y": 41.529930686396256
    },
    "is_published": false
}